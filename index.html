<!DOCTYPE html>
<html>
	<head>
		<link rel="stylesheet" type="text/css" href="style.css" />
		<link rel="stylesheet" href="formStyle.css"/>
		<script src="./jquery-3.4.1.slim.min.js"></script>
		<script type="text/javascript" src="./app.js"></script>
		<script src="./formValidation.js"></script>
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
		<script src="http://ajax.aspnetcdn.com/ajax/jquery.validate/1.11.1/jquery.validate.min.js"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-modal/0.9.1/jquery.modal.min.js"></script>
		<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jquery-modal/0.9.1/jquery.modal.min.css" />	
		<script>
			// Check browser support
			if (typeof(Storage) !== "undefined") {
			  sessionStorage.setItem("p", "p");
			} else {
			  console.log( "Sorry, your browser does not support Web Storage...");
			}
			</script>
		<script>
			$(document).ready(function(){
				$('div:not(#welcome)').hide();
				$('#welcome').show();
			});
		</script>
	</head>
	<body>
		<content>
			<div id="myModal" class="modal" title="About">
				<p style="text-align: center; font-size: large;">About Us</p>
				<p style="font-size: small;">This game was created by Dor Elkabetz & Marina Botvinnik</p>
			  </div>
			<div id="welcome" class="notGame">
					<p>
						<img src="logo2.png"  class="image1">
						GAME ON!
						<br/>
						<button class="button" type="button" onclick="switchToSignIn()">Sign Up</button>
						<button class="button" id="loginButton" type="button" onclick="switchToLogin()">Log In</button>
					</p>
			</div>
			<div id="login" class="notGame">
				<p class="container">
					<br/>
					<br/>
					<br/>
					<br/>
					<br/>
					<label for="uname">Username</label>
					<input id ="uname" type="text" placeholder="Enter Username" name="uname" required>
					<br/>
					<br/>
					<label for="psw"><b>Password</b></label>
					<input id ="psw" type="password" placeholder="Enter Password" name="psw" required>
					<br/>
					<br/>
					<button class="button" type="submit" onclick="checkLogin()">Login</button>
					<button class="button" onclick="backToWelcome()">Back</button>
				</p>
			</div>
			<div id="register" class="notGame">
				<form action="" name="registration" id="form">
					<br/>
					Sign Up
					<img src="ghost2.gif"  class="image2">
					<br/>
					<br/>
					<input id="first" type="text" name="firstname" placeholder="First Name" />
					<input id="last" type="text" name="lastname" placeholder="Last Name" />
					<input id="username" type="text" name="username" placeholder="Username" />
					<br/>
					<input id="password" type="password" name="password" placeholder="Password" />
					<input id="email" type="text" name="email" placeholder="E-mail" />
					<p style="font-size: small;">choose your B-day:</p>
					<select id="year"></select>
					<select id="month"></select>
					<select id="day"></select>
					<br/>
					<br/>
					<button class="button" id="submitButton" type="submit" onclick="signUp()">Sign Me Up!</button>
					<button class="button" onclick="backToWelcome()">Back</button>
				</form>
			</div>
			<div id="properties">
			</div>
			<nav id="menu">
				<li><a href="#welcome">Welcome</a></li>
				<li><a href="#register">Register</a></li>
				<li><a href="#login">Log in</a></li>
				<li><a href="#myModal" rel="modal:open">About</a></li>
			</nav>
			<div id="score">
				<label for="lblScore">SCORE:</label>
				<input id="lblScore" type="text" />
			</div>
			<div id="time">
				<label for="lblTime">TIME:</label>
				<input id="lblTime" type="text" />
			</div>
			<div id="game">
				<canvas id="canvas" height="600" width="600"></canvas>
			</div>
		</content>
	</body>

	<script type="text/javascript">
		function switchToLogin(){
			$('#welcome').hide();
			$('#login').show();
		};
	</script>

	<script type="text/javascript">
		function switchToSignIn(){
			$('#welcome').hide();
			$('#register').show();
		};
	</script>

	<script type="text/javascript">
		function checkLogin(){
			var inputUserName = document.getElementById("uname").value;
			var inputPassword = document.getElementById("psw").value;
			var check = sessionStorage.getItem(inputUserName);
			console.log(check);
			if(inputPassword === check){
				$('#login').hide();
				$('#game').show();
				$('#menu').show();
				$('#time').show();
				$('#score').show();
			}
			else{
				window.alert("Your Username or Password is invalid. (Maybe you didn't sign in?)");
			}
		};
	</script>

	<script type="text/javascript">
		function backToWelcome(){
				$('div:not(#welcome)').hide();
				$('#welcome').show();
				$('#myModal').show();
			};
	</script>

	<script>
	$(document).ready(function() {
		const monthNames = ["January", "February", "March", "April", "May", "June",
		"July", "August", "September", "October", "November", "December"
		];
		var qntYears = 31;
		var selectYear = $("#year");
		var selectMonth = $("#month");
		var selectDay = $("#day");
		var currentYear = new Date().getFullYear();
		
		for (var y = 0; y < qntYears; y++){
			let date = new Date(currentYear);
			var yearElem = document.createElement("option");
			yearElem.value = currentYear 
			yearElem.textContent = currentYear;
			selectYear.append(yearElem);
			currentYear--;
		} 

		for (var m = 0; m < 12; m++){
			let monthNum = new Date(2018, m).getMonth()
			let month = monthNames[monthNum];
			var monthElem = document.createElement("option");
			monthElem.value = monthNum; 
			monthElem.textContent = month;
			selectMonth.append(monthElem);
			}

			var d = new Date();
			var month = d.getMonth();
			var year = d.getFullYear();
			var day = d.getDate();

			selectYear.val(year); 
			selectYear.on("change", AdjustDays);  
			selectMonth.val(month);    
			selectMonth.on("change", AdjustDays);

			AdjustDays();
			selectDay.val(day)
			
			function AdjustDays(){
			var year = selectYear.val();
			var month = parseInt(selectMonth.val()) + 1;
			selectDay.empty();
			
			//get the last day, so the number of days in that month
			var days = new Date(year, month, 0).getDate(); 
			
			//lets create the days of that month
			for (var d = 1; d <= days; d++){
				var dayElem = document.createElement("option");
				dayElem.value = d; 
				dayElem.textContent = d;
				selectDay.append(dayElem);
			}
			}    
});
	</script>

	<script type="text/javascript">
		function signUp(){
			if ($("#username").valid() == true && $("#password").valid()== true && $("#first").valid() == true && $("#last").valid() == true && $("#email").valid() == true) {
				var inputUserName = document.getElementById("username").value;
				var inputPassword = document.getElementById("password").value;
				var check = sessionStorage.getItem(inputUserName);
				if(check !== null){
					window.alert("you already signed up!\n Go back and log in with your username and password");
				}
				else {
					sessionStorage.setItem(inputUserName,inputPassword);
					window.alert("You signed in correctly!");
				}
				event.preventDefault();
			}
			else{
				window.alert("check your form");
			}
		};
	</script>
	<script>
			console.log("inTheFunction");
		var modal = document.getElementById("myModal");
		var btn = document.getElementById("about");
		var span = document.getElementsByClassName("close")[0];
		$(btn).click(function(e){
		e.preventDefault();
		modal.style.display = "block";
		});
		// span.onclick = function() {
		//   modal.style.display = "none";
		// }
		window.onclick = function(event) {
		  if (event.target == modal) {
			modal.style.display = "none";
		  }
		}
	</script>
</html>
