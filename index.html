<!DOCTYPE html>
<html>
	<head>
		<link rel="shortcut icon" href="#" />
		<link rel="stylesheet" type="text/css" href="style.css" />
		<link rel="stylesheet" href="formStyle.css"/>
		<link rel="stylesheet" href="gameStyle.css"/>
		<script src="./jquery-3.4.1.slim.min.js"></script>
		<script type="text/javascript" src="./monsters.js"></script>
		<script type="text/javascript" src="./app.js"></script>
		<script src="./formValidation.js"></script>
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
		<script src="https://ajax.aspnetcdn.com/ajax/jquery.validate/1.11.1/jquery.validate.min.js"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-modal/0.9.1/jquery.modal.min.js"></script>
		<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
		<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jquery-modal/0.9.1/jquery.modal.min.css" />	
		<script>
			// Check browser support
			if (typeof(Storage) !== "undefined") {
			  sessionStorage.setItem("p", "p");
			} else {
			  console.log( "Sorry, your browser does not support Web Storage...");
			}
			</script>
		<script>
			$(document).ready(function(){
				$('div:not(#welcome)').hide();
				// $("#allStuffForGame").show();
				$('#welcome').show();
				// $('div').hide();
				// $("#game").show();
				// $("#score").show();
				// $('#lblFinalScore').show();
				// start_time = new Date();

			});
		</script>
	</head>
	<body>
		<content>
			<div id="myModal" class="modal">
				<p style="text-align: center; font-size: large;">About Us</p>
				<p style="font-size: small;">This game was created by Dor Elkabetz & Marina Botvinnik</p>
				<p style="font-size: small;">We used form Validation and modal jQuery plugins</p>
				<p style="font-size: small;">The real struggle of this game was to make the ghosts move correctly, and to make the button chooser in an interesting way</p>
				<p style="font-size: small;">For more info contact us!</p>
				<p style="font-size: small;">Marina: botvimar@post.bgu.ac.il</p>
				<p style="font-size: small;">Dor: dorelkab@post.bgu.ac.il</p>
			  </div>
			<div id="welcome" class="notGame">
					<p style="padding-top: 60px;">
						<img src="pictures\\logo2.png"  class="image1">
						GAME ON!
						<br/>
						<button class="button" type="button" onclick="switchToSignIn()">Sign Up</button>
						<button class="button" id="loginButton" type="button" onclick="switchToLogin()">Log In</button>
					</p>
			</div>
			<div id="login" class="notGame">
				<p class="container">
					<br/>
					<br/>
					Login
					<br/>
					<br/>
					<label for="uname">Username</label>
					<input id ="uname" type="text" placeholder="Enter Username" name="uname" required>
					<br/>
					<br/>
					<label for="psw"><b>Password</b></label>
					<input id ="psw" type="password" placeholder="Enter Password" name="psw" required>
					<br/>
					<br/>
					<button class="button" type="submit" onclick="checkLogin()">Login</button>
					<button class="button" onclick="backToWelcome()">Back</button>
				</p>
			</div>
			<div id="register" class="notGame">
				<form action="" name="registration" id="form">
					<br/>
					Sign Up
					<img src="pictures\\ghost2.gif"  class="image2">
					<br/>
					<br/>
					<input id="first" type="text" name="firstname" placeholder="First Name" />
					<input id="last" type="text" name="lastname" placeholder="Last Name" />
					<input id="username" type="text" name="username" placeholder="Username" />
					<br/>
					<input id="password" type="password" name="password" placeholder="Password" />
					<input id="email" type="text" name="email" placeholder="E-mail" />
					<p style="font-size: small;">choose your B-day:</p>
					<select id="year" style="font-size: small;"></select>
					<select id="month"style="font-size: small;"></select>
					<select id="day" style="font-size: small;"></select>
					<br/>
					<br/>
					<button class="button" id="submitButton" type="submit" onclick="signUp()">Sign Me Up!</button>
					<button class="button" onclick="backToWelcome()">Back</button>
				</form>
			</div>
			<div id="properties" class="notGame">
				<br/>
				<form action="" name="properties" id="form">
					Properties
					<img src="crazyRed.gif" class="image3">
					<br/>
					<br/>
					<button class="button" id="upButton"  onclick="setUpKey()">&#129093;&ensp;</button>
					<button class="button" id="downButton"  onclick="setDownKey()">&#129095;&ensp;</button>
					<button class="button" id="leftButton"  onclick="setLeftKey()">&#129092;&ensp;</button>
					<button class="button" id="rightButton"  onclick="setRightKey()">&#129094;&ensp;</button>
					<br/>
					<br/>
					<p style="font-size: small;">Number of balls:
					<select id="numOfBAlls" name="numOfBAlls"></select></p>
					<p style="font-size: small;">5 points:<select id="ball5" name="ball5"></select>
					15 points:<select id="ball15" name="ball15"></select> 25 points:<select id="ball25" name="ball25"></select></p>
					<p style="font-size: small;">Time limit (in seconds):<input id="timeLimit" type="text" name="time" placeholder="time" /></p>
					<p style="font-size: small;">Number of monsters:<select id="numOfMonsters" name="numOfMonsters"></select></p>
					<button class="button" onclick="backToWelcome()">Back</button>
					<button class="button" id="random" onclick="random1()">Random</button>
					<br/>
					<button class="button" id="go" type="submit" onclick="go1()">Go!</button>
				</form>
			</div>
			<section id="allStuffForGame">
				<nav id="menu">
					<li><a href="#welcome" onclick="backToWelcome()">Welcome</a></li>
					<li><a href="#register" onclick="switchToSignIn()">Register</a></li>
					<li><a href="#login" onclick="switchToLogin()">Log in</a></li>
					<li><a href="#properties" onclick="switchToProporties()">Properties</a></li>
					<li><a href="#myModal" rel="modal:open">About</a></li>
					<li ><img src="pictures/logo2.png" width="60" height="40"/></li>
				</nav>
				<div id="score" class="info">
					<label id="lblName"></label>
					<label for="lblScore">LIFES:</label>
					<input id="lblLifes" type="text" />
					<label for="lblScore">SCORE:</label>
					<input id="lblScore" type="text" />
					<label for="lblTime">TIME:</label>
					<input id="lblTime" type="text"/>
				</div>
				<div id="game" class="row">
					<img id="pill" src="pictures/pill2.gif" alt="The Pill" style="display: none;">
					<img id="clock" src="pictures/clock3.gif" alt="Clock" style="display: none;">
					<img id="ghost1" src="pictures/ghost3.gif" alt="Ghost" style="display: none;">
					<img id="ghost2" src="pictures/ghost2.gif" alt="Ghost" style="display: none;">
					<img id="ghost3" src="pictures/ghost5.gif" alt="Ghost" style="display: none;">
					<img id="ghost4" src="pictures/ghost4.gif" alt="Ghost" style="display: none;">
					<img id="coin" src="pictures/coin.gif" alt="Coin" style="border-radius: 100%; display: none;">
					<label id="lblFinalScore" style="padding-left: 40%;"></label>
					<div class = "col-md-8">
					<canvas id="canvas" height="600" width="900"></canvas>
					</div>
					<br/>
					<div id="ShowProperties" class = "col-md-3">
						<label id="ballsNum"></label> <br/>
						<label id="5poi"></label><br/>
						<label id="15poi"></label><br/>
						<label id="25poi"></label><br/>
						<label id="timeLimit1"></label><br/>
						<label id="monsterNum"></label><br/>
					</div>
				</div>
				<div id="restart">
					<br/>
					<button id = "rbutton" class="button" onclick="restart()">Restart Game</button>
					<br/>
					<br/>
				</div>
			</section>
		</content>
		<footer style="margin-top: 0px; font-size: small; border:rgba(255, 255, 0, 0.521) 2px solid; background: rgb(0, 0, 0); " id="footer"> Â© Dor Elkabetz & Marina Botvinnik. For any questions contact: botvimar@post.bgu.ac.il</footer>
	</body>

	<script type="text/javascript">
		function switchToLogin(){
			$('div:not(#login)').hide();
			$("#allStuffForGame").hide();
			$('#login').show();
			backMusic.pause();
			myMusic.play();
			$("#lblFinalScore").hide();
			$("#lblFinalScore").html('');
			clearIntervals();
		};

		function switchToProporties(){
		$("#lblFinalScore").hide();
		$("#lblFinalScore").html('');
		$('div:not(#properties)').hide();
		$("#allStuffForGame").hide();
		$('#properties').show();
		backMusic.pause();
		myMusic.play();
		clearIntervals();
		
	};

	function switchToSignIn(){
			$('div:not(#register)').hide();
			$("#allStuffForGame").hide();
			$('#register').show();
			backMusic.pause();
			myMusic.play();
		};
		function restart(){
			$("#lblFinalScore").hide();
			$("#lblFinalScore").html('');
			start_time = new Date();
			clearIntervals();
			Start();
		};
</script>


	<script type="text/javascript">
		function checkLogin(){
			var inputUserName = document.getElementById("uname").value;
			var inputPassword = document.getElementById("psw").value;
			var check = sessionStorage.getItem(inputUserName);
			if(inputPassword === check){
				$('#login').hide();
				$('#properties').show();
			}
			else{
				window.alert("Your Username or Password is invalid. (Maybe you didn't sign in?)");
			}
		};
	</script>

	<script type="text/javascript">
		function backToWelcome(){
				$("#lblFinalScore").hide();
				$("#lblFinalScore").html('');
				$('div:not(#welcome)').hide();
				$('#welcome').show();
				backMusic.pause();
			};
	</script>

	<script>
	$(document).ready(function() {
		sessionStorage.removeItem("up");
		sessionStorage.removeItem("down");
		sessionStorage.removeItem("left");
		sessionStorage.removeItem("right");
		const monthNames = ["January", "February", "March", "April", "May", "June",
		"July", "August", "September", "October", "November", "December"
		];
		const colorNames1=["red", "green", "yellow", "blue", "orange"];
		const colorNames2=["orange", "red", "green", "yellow", "blue"];
		const colorNames3=["blue", "orange", "red", "green", "yellow"];
		var ballsNum=90;
		var monstersNum=4;
		var qntYears = 31;
		var selectYear = $("#year");
		var selectMonth = $("#month");
		var selectDay = $("#day");
		var selectNumOfBalls=$("#numOfBAlls");
		var select5Points=$("#ball5");
		var select15Points=$("#ball15");
		var select25Points=$("#ball25");
		var selectMonster=$("#numOfMonsters");
		var currentYear = new Date().getFullYear();

		for(var mon=0; mon<4; mon++){
			var monElem=document.createElement("option");
			monElem.value=monstersNum;
			monElem.textContent=monstersNum;
			selectMonster.append(monElem);
			monstersNum--;
		}

		for(var i=0; i<41; i++){
			var ballElem=document.createElement("option");
			ballElem.value=ballsNum;
			ballElem.textContent=ballsNum;
			selectNumOfBalls.append(ballElem);
			ballsNum--;
		}

		for(var c=0; c<5; c++){
			var ball5pointElem=document.createElement("option");
			ball5pointElem.value=colorNames1[c];
			ball5pointElem.textContent=colorNames1[c];
			var ball15pointElem=document.createElement("option");
			ball15pointElem.value=colorNames2[c];
			ball15pointElem.textContent=colorNames2[c];
			var ball25pointElem=document.createElement("option");
			ball25pointElem.value=colorNames3[c];
			ball25pointElem.textContent=colorNames3[c];
			select5Points.append(ball5pointElem);
			select15Points.append(ball15pointElem);
			select25Points.append(ball25pointElem);
		}
		
		for (var y = 0; y < qntYears; y++){
			let date = new Date(currentYear);
			var yearElem = document.createElement("option");
			yearElem.value = currentYear 
			yearElem.textContent = currentYear;
			selectYear.append(yearElem);
			currentYear--;
		} 

		for (var m = 0; m < 12; m++){
			let monthNum = new Date(2018, m).getMonth()
			let month = monthNames[monthNum];
			var monthElem = document.createElement("option");
			monthElem.value = monthNum; 
			monthElem.textContent = month;
			selectMonth.append(monthElem);
			}

			var d = new Date();
			var month = d.getMonth();
			var year = d.getFullYear();
			var day = d.getDate();

			selectYear.val(year); 
			selectYear.on("change", AdjustDays);  
			selectMonth.val(month);    
			selectMonth.on("change", AdjustDays);

			AdjustDays();
			selectDay.val(day)
			
			function AdjustDays(){
			var year = selectYear.val();
			var month = parseInt(selectMonth.val()) + 1;
			selectDay.empty();
			
			//get the last day, so the number of days in that month
			var days = new Date(year, month, 0).getDate(); 
			
			//lets create the days of that month
			for (var d = 1; d <= days; d++){
				var dayElem = document.createElement("option");
				dayElem.value = d; 
				dayElem.textContent = d;
				selectDay.append(dayElem);
			}

			var balls=90;
			for (var i = 0; i <= 51; i++){
				var ballsElem = document.createElement("option");
				dayElem.value = d; 
				dayElem.textContent = d;
				selectDay.append(dayElem);
			}
			}    
});
	</script>

	<script type="text/javascript">
		function signUp(){
			if ($("#username").valid() == true && $("#password").valid()== true && $("#first").valid() == true && $("#last").valid() == true && $("#email").valid() == true) {
				var inputUserName = document.getElementById("username").value;
				var inputPassword = document.getElementById("password").value;
				var check = sessionStorage.getItem(inputUserName);
				if(check !== null){
					window.alert("you already signed up!\n Go back and log in with your username and password");
				}
				else {
					sessionStorage.setItem(inputUserName,inputPassword);
					window.alert("You signed in correctly!");
				}
				event.preventDefault();
			}
			else{
				window.alert("check your form");
			}
		};
	</script>
	<script type="text/javascript">

		function go1(){
			if($("#timeLimit").valid()==true && $("#ball5").valid()==true && $("#ball15").valid()==true && $("#ball25").valid()==true){
				var numOfBalls=document.getElementById("numOfBAlls").value;
				var ball5Color=document.getElementById("ball5").value;
				var ball15Color=document.getElementById("ball15").value;
				var ball25Color=document.getElementById("ball25").value;
				var time=document.getElementById("timeLimit").value;
				console.log(time);
				var numOfMonsters=document.getElementById("numOfMonsters").value;
				sessionStorage.setItem("time",time)
				sessionStorage.setItem("numOfBalls",numOfBalls);
				sessionStorage.setItem("ball5",ball5Color);
				sessionStorage.setItem("ball15",ball15Color);
				sessionStorage.setItem("ball25",ball25Color);
				sessionStorage.setItem("numOfMonsters",numOfMonsters);
				if(sessionStorage.getItem("up")==null){
					sessionStorage.setItem("up",38)
				}
				if(sessionStorage.getItem("down")==null){
					sessionStorage.setItem("down",40);
				}
				if(sessionStorage.getItem("right")==null){
					sessionStorage.setItem("right",39);
				}
				if(sessionStorage.getItem("left")==null){
					sessionStorage.setItem("left",37);
				}
				var inputUserName = document.getElementById("uname").value;
				event.preventDefault();
				$('#properties').hide();
				$('#game').show();
				$('#menu').show();
				$('#time').show();
				$('#score').show();
				$('#restart').show();
				$('#name').show();
				$("#lblName").html(''); $('#ballsNum').html('');
				$("#5poi").html(''); $("#15poi").html(''); $("#25poi").html(''); $("#monsterNum").html('');$("#timeLimit1").html('');
				$('#lblName').append("Player: "+ inputUserName);
				$('#ballsNum').append("Number of balls: "+ numOfBalls);
				$('#5poi').append("5 points: "+ ball5Color);
				$('#15poi').append("15 points: "+ ball15Color);
				$('#25poi').append("25 points: "+ ball25Color);
				$('#timeLimit1').append("Time Limit: "+ time);
				$('#monsterNum').append("Number Of Monsters: "+ numOfMonsters);
				$('#allStuffForGame').show();
				$(".col-md-3").show();
				$(".col-md-8").show();
				backMusic.play();
				start_time = new Date();
				$("#lblFinalScore").hide();
				$("#lblFinalScore").html('');
				clearIntervals();
				Start();
			}
			else{
				alert("please fill the proporties correctly");
			}
		}

		function random1(){
			event.preventDefault();
			sessionStorage.setItem("up",38);
			sessionStorage.setItem("down",40);
			sessionStorage.setItem("right",39);
			sessionStorage.setItem("left",37);
			document.getElementById("upButton");
			var but=document.getElementById("upButton").style.color="red";
			var but=document.getElementById("downButton").style.color="red";
			var but=document.getElementById("rightButton").style.color="red";
			var but=document.getElementById("leftButton").style.color="red";
			var randomNumberOfBalls=0 + Math.floor((40 - 0) * Math.random());
			var randomBallColor=0 + Math.floor((4 - 0) * Math.random());
			var randomTime=60 + Math.floor((120 - 60) * Math.random());
			var randomNumberOfMons=0 + Math.floor((3 - 0) * Math.random());
			$("#numOfBAlls").val(document.getElementById("numOfBAlls").childNodes.item(randomNumberOfBalls).textContent).trigger("change");
			$("#ball5").val(document.getElementById("ball5").childNodes.item(randomBallColor).textContent).trigger("change");
			$("#ball15").val(document.getElementById("ball15").childNodes.item(randomBallColor).textContent).trigger("change");
			$("#ball25").val(document.getElementById("ball25").childNodes.item(randomBallColor).textContent).trigger("change");
			$("#timeLimit").val(randomTime).trigger("change");
			$("#numOfMonsters").val(document.getElementById("numOfMonsters").childNodes.item(randomNumberOfMons).textContent).trigger("change");
		};
		function setUpKey(){
			event.preventDefault();
			var but=document.getElementById("upButton");
			document.getElementById("upButton").addEventListener('keydown',(event)=> {
			let key = event.keyCode;
			if((key==sessionStorage.getItem("down") || key==sessionStorage.getItem("right") || key==sessionStorage.getItem("left"))){
				window.alert("you already chose this key, please pick another");
			}
			else {
				sessionStorage.setItem("up",key);
				but.style.color="red";
			}
		});
		};
		function setDownKey(){
			event.preventDefault();
			var but=document.getElementById("downButton");
			document.getElementById("downButton").addEventListener('keydown',(event)=> {
			let key = event.keyCode;
			if((key==sessionStorage.getItem("up") || key==sessionStorage.getItem("right") || key==sessionStorage.getItem("left"))){
				window.alert("you already chose this key, please pick another");
			}
			else{
				sessionStorage.setItem("down",key);
				but.style.color="red";
			}
		});
		};
		function setRightKey(){
			event.preventDefault();
			var but=document.getElementById("rightButton");
			document.getElementById("rightButton").addEventListener('keydown',(event)=> {
			let key = event.keyCode;
			if(key==sessionStorage.getItem("down") || key==sessionStorage.getItem("up") || key==sessionStorage.getItem("left")){
				window.alert("you already chose this key, please pick another");
			}
			else{
				sessionStorage.setItem("right",key);
				but.style.color="red";
			}
		});
		};
		function setLeftKey(){
			event.preventDefault();
			var but=document.getElementById("leftButton");
			document.getElementById("leftButton").addEventListener('keydown',(event)=> {
			let key = event.keyCode;
			if(key==sessionStorage.getItem("down") || key==sessionStorage.getItem("right") || key==sessionStorage.getItem("right")){
				window.alert("you already chose this key, please pick another");
			}
			else{
				sessionStorage.setItem("left",key);
				but.style.color="red";
			}
		});
		};
	</script>
</html>
